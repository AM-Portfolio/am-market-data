# PostgreSQL Configuration
POSTGRES_PASSWORD: password
POSTGRES_USERNAME: postgres
POSTGRES_URL: jdbc:postgresql://localhost:5456
POSTGRES_DATABASE: portfolio

# InfluxDB Configuration
INFLUXDB_TOKEN: my-super-secret-auth-token
INFLUXDB_ORG: am_investment
INFLUXDB_BUCKET: market_data
INFLUXDB_URL: http://localhost:8087

# Grafana Configuration
GRAFANA_ADMIN_USER: 1109403
GRAFANA_ADMIN_PASSWORD: XXXXXXXXXX

# Kafka Configuration
KAFKA_BOOTSTRAP_SERVERS: localhost:9092
KAFKA_ZOOKEEPER_CONNECT: localhost:2181
KAFKA_ADVERTISED_LISTENERS: PLAINTEXT://localhost:9092
KAFKA_LISTENER_SECURITY_PROTOCOL_MAP: PLAINTEXT:PLAINTEXT
KAFKA_INTER_BROKER_LISTENER_NAME: PLAINTEXT
KAFKA_CONSUMER_GROUP_ID: am-market-data-service
KAFKA_CONSUMER_AUTO_OFFSET_RESET: earliest

# Application Configuration
STOKUPATE_TOPIC_NAME: am-stock-price-update
NSE_INDICES_TOPIC_NAME: nse-indices-update
NSE_ETF_TOPIC_NAME: nse-etf-update

MARKET_DATA_MAX_RETRIES: 3
MARKET_DATA_RETRY_DELAY_MS: 1000
MARKET_DATA_THREAD_POOL_SIZE: 5
MARKET_DATA_THREAD_QUEUE_CAPACITY: 10
MARKET_DATA_MAX_AGE_MINUTES: 15

# Upstox Configuration
UPSTOX_ACCESS_TOKEN: XXXXXXXXXXXXXXXXXXXXXXXXX
UPSTOX_API_KEY: XXXXXXXXXXXXXXXXXXXXXXXXX
UPSTOX_SECRET_KEY: XXXXXXXXXXXXXXXXX
UPSTOX_CODE: XXXXXXXXX 

server:
  port: 8084

spring:
  application:
    name: market-data-service
  
  # Database Configuration
  datasource:
    url: ${POSTGRES_URL}/${POSTGRES_DATABASE}
    username: ${POSTGRES_USERNAME}
    password: ${POSTGRES_PASSWORD}
    driver-class-name: org.postgresql.Driver
    
  # InfluxDB Configuration
  influx:
    url: ${INFLUXDB_URL}
    token: ${INFLUXDB_TOKEN}
    org: ${INFLUXDB_ORG}
    bucket: ${INFLUXDB_BUCKET}
    
  # Kafka Configuration
  kafka:
    bootstrap-servers: ${KAFKA_BOOTSTRAP_SERVERS}
    consumer:
      group-id: ${KAFKA_CONSUMER_GROUP_ID}
      auto-offset-reset: ${KAFKA_CONSUMER_AUTO_OFFSET_RESET}
  
  config:
    import:
      - classpath:isin.yml

  jpa:
    hibernate:
      ddl-auto: update
    properties:
      hibernate:
        dialect: org.hibernate.dialect.PostgreSQLDialect
        format_sql: true
    show-sql: true

app:
  kafka:
    stock-price-topic: ${STOKUPATE_TOPIC_NAME}
    nse-indices-topic: ${NSE_INDICES_TOPIC_NAME}
    nse-etf-topic: ${NSE_ETF_TOPIC_NAME}
  
  retry:
    max-attempts: ${MARKET_DATA_MAX_RETRIES}
    base-delay-ms: ${MARKET_DATA_RETRY_DELAY_MS}
  
  thread-pool:
    size: ${MARKET_DATA_THREAD_POOL_SIZE}
    queue-capacity: ${MARKET_DATA_THREAD_QUEUE_CAPACITY}
  
  validation:
    max-age-minutes: ${MARKET_DATA_MAX_AGE_MINUTES}

upstox:
  interval: I1
  auth:
    base-url: https://api.upstox.com/v2
    code: ${UPSTOX_CODE}
    api-key: ${UPSTOX_API_KEY}
    secret-key: ${UPSTOX_SECRET_KEY}
    access-token: ${UPSTOX_ACCESS_TOKEN}
    redirect-uri: http://localhost:8080
    authorization-url: https://api-v2.upstox.com/login/authorization/dialog
    token-url: https://api-v2.upstox.com/login/authorization/token
    token-refresh-interval: 3600000
    scope: orders feed portfolio

scraper:
  urls:
    - https://www.nseindia.com/

# Logging Configuration
logging:
  level:
    root: INFO
    '[com.am.marketdata.scheduler]': INFO

  pattern:
    console: "%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n"